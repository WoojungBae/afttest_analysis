#-------------------------------------------------------------
#---------------------------SETTING---------------------------
#-------------------------------------------------------------
library(afttest)
library(survival)

#-------------------------------------------------------------
#---------------------------- DATA ---------------------------
#-------------------------------------------------------------
set.seed(1)

D_pbc = pbc$status; D_pbc[which(D_pbc==1)]=0; D_pbc[which(D_pbc==2)]=1
X_pbc = pbc$time
X_pbc = X_pbc + runif(length(X_pbc))/1e4

trt  = pbc$trt-1
edem = pbc$edem
age  = pbc$age; log_age=log(age)
bili = pbc$bili; log_bili=log(bili)
prot = pbc$prot; log_prot=log(prot)
albu = pbc$albu; log_albu=log(albu)

# ------------------------------------------------------------------------------
# ------------------------------------ "mns" -----------------------------------
# ------------------------------------------------------------------------------

# ------------------------------------------------------------------------------
# ------------------- Covariates: bili+prot+albu+age+edem+trt ------------------
# ------------------------------------------------------------------------------

# ------------------------------------ omni ------------------------------------
result01_afttest_omni_mns=afttest(Surv(X_pbc,D_pbc)~bili+prot+albu+age+edem+trt,path=200,testType="omni",eqType="mns", pathsave = 50)
result01_afttest_omni_mns$p_value
result01_afttest_omni_mns$p_std_value
# afttestplot(result01_afttest_omni_mns,stdType="unstd", pathsave = 50)
# afttestplot(result01_afttest_omni_mns,stdType="std", pathsave = 50)

# ------------------------------------ link ------------------------------------
result01_afttest_link_mns=afttest(Surv(X_pbc,D_pbc)~bili+prot+albu+age+edem+trt,path=200,testType="link",eqType="mns", pathsave = 50)
result01_afttest_link_mns$p_value
result01_afttest_link_mns$p_std_value
# afttestplot(result01_afttest_link_mns,stdType="unstd", pathsave = 50)
# afttestplot(result01_afttest_link_mns,stdType="std", pathsave = 50)

# ------------------------------------ form ------------------------------------
result01_afttest_form1_mns=afttest(Surv(X_pbc,D_pbc)~bili+prot+albu+age+edem+trt,path=200,testType="form",eqType="mns",form="bili", pathsave = 50)
result01_afttest_form1_mns$p_value
result01_afttest_form1_mns$p_std_value
# afttestplot(result01_afttest_form1_mns,stdType="unstd", pathsave = 50)
# afttestplot(result01_afttest_form1_mns,stdType="std", pathsave = 50)

result01_afttest_form2_mns=afttest(Surv(X_pbc,D_pbc)~bili+prot+albu+age+edem+trt,path=200,testType="form",eqType="mns",form="prot", pathsave = 50)
result01_afttest_form2_mns$p_value
result01_afttest_form2_mns$p_std_value
# afttestplot(result01_afttest_form2_mns,stdType="unstd", pathsave = 50)
# afttestplot(result01_afttest_form2_mns,stdType="std", pathsave = 50)

result01_afttest_form3_mns=afttest(Surv(X_pbc,D_pbc)~bili+prot+albu+age+edem+trt,path=200,testType="form",eqType="mns",form="albu", pathsave = 50)
result01_afttest_form3_mns$p_value
result01_afttest_form3_mns$p_std_value
# afttestplot(result01_afttest_form3_mns,stdType="unstd", pathsave = 50)
# afttestplot(result01_afttest_form3_mns,stdType="std", pathsave = 50)

result01_afttest_form4_mns=afttest(Surv(X_pbc,D_pbc)~bili+prot+albu+age+edem+trt,path=200,testType="form",eqType="mns",form="age", pathsave = 50)
result01_afttest_form4_mns$p_value
result01_afttest_form4_mns$p_std_value
# afttestplot(result01_afttest_form4_mns,stdType="unstd", pathsave = 50)
# afttestplot(result01_afttest_form4_mns,stdType="std", pathsave = 50)

# # ------------------------------------------------------------------------------
# # ----------------- Covariates: log_bili+prot+albu+age+edem+trt ----------------
# # ------------------------------------------------------------------------------
# 
# # ------------------------------------ omni ------------------------------------
# result02_afttest_omni_mns=afttest(Surv(X_pbc,D_pbc)~log_bili+prot+albu+age+edem+trt,path=200,testType="omni",eqType="mns", pathsave = 50)
# result02_afttest_omni_mns$p_value
# result02_afttest_omni_mns$p_std_value
# # afttestplot(result02_afttest_omni_mns,stdType="unstd", pathsave = 50)
# # afttestplot(result02_afttest_omni_mns,stdType="std", pathsave = 50)
# 
# # ------------------------------------ link ------------------------------------
# result02_afttest_link_mns=afttest(Surv(X_pbc,D_pbc)~log_bili+prot+albu+age+edem+trt,path=200,testType="link",eqType="mns", pathsave = 50)
# result02_afttest_link_mns$p_value
# result02_afttest_link_mns$p_std_value
# # afttestplot(result02_afttest_link_mns,stdType="unstd", pathsave = 50)
# # afttestplot(result02_afttest_link_mns,stdType="std", pathsave = 50)
# 
# # ------------------------------------ form ------------------------------------
# result02_afttest_form1_mns=afttest(Surv(X_pbc,D_pbc)~log_bili+prot+albu+age+edem+trt,path=200,testType="form",eqType="mns",form="log_bili", pathsave = 50)
# result02_afttest_form1_mns$p_value
# result02_afttest_form1_mns$p_std_value
# # afttestplot(result02_afttest_form1_mns,stdType="unstd", pathsave = 50)
# # afttestplot(result02_afttest_form1_mns,stdType="std", pathsave = 50)
# 
# result02_afttest_form2_mns=afttest(Surv(X_pbc,D_pbc)~log_bili+prot+albu+age+edem+trt,path=200,testType="form",eqType="mns",form="prot", pathsave = 50)
# result02_afttest_form2_mns$p_value
# result02_afttest_form2_mns$p_std_value
# # afttestplot(result02_afttest_form2_mns,stdType="unstd", pathsave = 50)
# # afttestplot(result02_afttest_form2_mns,stdType="std", pathsave = 50)
# 
# result02_afttest_form3_mns=afttest(Surv(X_pbc,D_pbc)~log_bili+prot+albu+age+edem+trt,path=200,testType="form",eqType="mns",form="albu", pathsave = 50)
# result02_afttest_form3_mns$p_value
# result02_afttest_form3_mns$p_std_value
# # afttestplot(result02_afttest_form3_mns,stdType="unstd", pathsave = 50)
# # afttestplot(result02_afttest_form3_mns,stdType="std", pathsave = 50)
# 
# result02_afttest_form4_mns=afttest(Surv(X_pbc,D_pbc)~log_bili+prot+albu+age+edem+trt,path=200,testType="form",eqType="mns",form="age", pathsave = 50)
# result02_afttest_form4_mns$p_value
# result02_afttest_form4_mns$p_std_value
# # afttestplot(result02_afttest_form4_mns,stdType="unstd", pathsave = 50)
# # afttestplot(result02_afttest_form4_mns,stdType="std", pathsave = 50)
# 
# # ------------------------------------------------------------------------------
# # ------------------------------------ "mis" -----------------------------------
# # ------------------------------------------------------------------------------
# 
# # ------------------------------------------------------------------------------
# # ------------------- Covariates: bili+prot+albu+age+edem+trt ------------------
# # ------------------------------------------------------------------------------
# 
# # ------------------------------------ omni ------------------------------------
# result01_afttest_omni_mis=afttest(Surv(X_pbc,D_pbc)~bili+prot+albu+age+edem+trt,path=200,testType="omni",eqType="mis", pathsave = 50)
# result01_afttest_omni_mis$p_value
# result01_afttest_omni_mis$p_std_value
# # afttestplot(result01_afttest_omni_mis,stdType="unstd", pathsave = 50)
# # afttestplot(result01_afttest_omni_mis_mis,stdType="std", pathsave = 50)
# 
# # ------------------------------------ link ------------------------------------
# result01_afttest_link_mis=afttest(Surv(X_pbc,D_pbc)~bili+prot+albu+age+edem+trt,path=200,testType="link",eqType="mis", pathsave = 50)
# result01_afttest_link_mis$p_value
# result01_afttest_link_mis$p_std_value
# # afttestplot(result01_afttest_link_mis,stdType="unstd", pathsave = 50)
# # afttestplot(result01_afttest_link_mis,stdType="std", pathsave = 50)
# 
# # ------------------------------------ form ------------------------------------
# result01_afttest_form1_mis=afttest(Surv(X_pbc,D_pbc)~bili+prot+albu+age+edem+trt,path=200,testType="form",eqType="mis",form="bili", pathsave = 50)
# result01_afttest_form1_mis$p_value
# result01_afttest_form1_mis$p_std_value
# # afttestplot(result01_afttest_form1_mis,stdType="unstd", pathsave = 50)
# # afttestplot(result01_afttest_form1_mis,stdType="std", pathsave = 50)
# 
# result01_afttest_form2_mis=afttest(Surv(X_pbc,D_pbc)~bili+prot+albu+age+edem+trt,path=200,testType="form",eqType="mis",form="prot", pathsave = 50)
# result01_afttest_form2_mis$p_value
# result01_afttest_form2_mis$p_std_value
# # afttestplot(result01_afttest_form2_mis,stdType="unstd", pathsave = 50)
# # afttestplot(result01_afttest_form2_mis,stdType="std", pathsave = 50)
# 
# result01_afttest_form3_mis=afttest(Surv(X_pbc,D_pbc)~bili+prot+albu+age+edem+trt,path=200,testType="form",eqType="mis",form="albu", pathsave = 50)
# result01_afttest_form3_mis$p_value
# result01_afttest_form3_mis$p_std_value
# # afttestplot(result01_afttest_form3_mis,stdType="unstd", pathsave = 50)
# # afttestplot(result01_afttest_form3_mis,stdType="std", pathsave = 50)
# 
# result01_afttest_form4_mis=afttest(Surv(X_pbc,D_pbc)~bili+prot+albu+age+edem+trt,path=200,testType="form",eqType="mis",form="age", pathsave = 50)
# result01_afttest_form4_mis$p_value
# result01_afttest_form4_mis$p_std_value
# # afttestplot(result01_afttest_form4_mis,stdType="unstd", pathsave = 50)
# # afttestplot(result01_afttest_form4_mis,stdType="std", pathsave = 50)
# 
# # ------------------------------------------------------------------------------
# # ----------------- Covariates: log_bili+prot+albu+age+edem+trt ----------------
# # ------------------------------------------------------------------------------
# 
# # ------------------------------------ omni ------------------------------------
# result02_afttest_omni_mis=afttest(Surv(X_pbc,D_pbc)~log_bili+prot+albu+age+edem+trt,path=200,testType="omni",eqType="mis", pathsave = 50)
# result02_afttest_omni_mis$p_value
# result02_afttest_omni_mis$p_std_value
# # afttestplot(result02_afttest_omni_mis,stdType="unstd", pathsave = 50)
# # afttestplot(result02_afttest_omni_mis,stdType="std", pathsave = 50)
# 
# # ------------------------------------ link ------------------------------------
# result02_afttest_link_mis=afttest(Surv(X_pbc,D_pbc)~log_bili+prot+albu+age+edem+trt,path=200,testType="link",eqType="mis", pathsave = 50)
# result02_afttest_link_mis$p_value
# result02_afttest_link_mis$p_std_value
# # afttestplot(result02_afttest_link_mis,stdType="unstd", pathsave = 50)
# # afttestplot(result02_afttest_link_mis,stdType="std", pathsave = 50)
# 
# # ------------------------------------ form ------------------------------------
# result02_afttest_form1_mis=afttest(Surv(X_pbc,D_pbc)~log_bili+prot+albu+age+edem+trt,path=200,testType="form",eqType="mis",form="log_bili", pathsave = 50)
# result02_afttest_form1_mis$p_value
# result02_afttest_form1_mis$p_std_value
# # afttestplot(result02_afttest_form1_mis,stdType="unstd", pathsave = 50)
# # afttestplot(result02_afttest_form1_mis,stdType="std", pathsave = 50)
# 
# result02_afttest_form2_mis=afttest(Surv(X_pbc,D_pbc)~log_bili+prot+albu+age+edem+trt,path=200,testType="form",eqType="mis",form="prot", pathsave = 50)
# result02_afttest_form2_mis$p_value
# result02_afttest_form2_mis$p_std_value
# # afttestplot(result02_afttest_form2_mis,stdType="unstd", pathsave = 50)
# # afttestplot(result02_afttest_form2_mis,stdType="std", pathsave = 50)
# 
# result02_afttest_form3_mis=afttest(Surv(X_pbc,D_pbc)~log_bili+prot+albu+age+edem+trt,path=200,testType="form",eqType="mis",form="albu", pathsave = 50)
# result02_afttest_form3_mis$p_value
# result02_afttest_form3_mis$p_std_value
# # afttestplot(result02_afttest_form3_mis,stdType="unstd", pathsave = 50)
# # afttestplot(result02_afttest_form3_mis,stdType="std", pathsave = 50)
# 
# result02_afttest_form4_mis=afttest(Surv(X_pbc,D_pbc)~log_bili+prot+albu+age+edem+trt,path=200,testType="form",eqType="mis",form="age", pathsave = 50)
# result02_afttest_form4_mis$p_value
# result02_afttest_form4_mis$p_std_value
# # afttestplot(result02_afttest_form4_mis,stdType="unstd", pathsave = 50)
# # afttestplot(result02_afttest_form4_mis,stdType="std", pathsave = 50)

# ------------------------------------------------------------------------------
# ------------------------------------------------------------------------------
# ------------------------------------------------------------------------------
beta01mns = aftsrr(Surv(X_pbc,D_pbc)~bili+prot+albu+age+edem+trt,eqType="mns",se="ISMB", pathsave = 50)
beta01mis = aftsrr(Surv(X_pbc,D_pbc)~bili+prot+albu+age+edem+trt,eqType="mis",se="ISMB", pathsave = 50)
summary(beta01mns)
cbind(coef(beta01mns) - 1.96 * sqrt(diag(vcov(beta01mns)$ISMB)),
      coef(beta01mns) + 1.96 * sqrt(diag(vcov(beta01mns)$ISMB)))
summary(beta01mis)
cbind(coef(beta01mis) - 1.96 * sqrt(diag(vcov(beta01mis)$ISMB)),
      coef(beta01mis) + 1.96 * sqrt(diag(vcov(beta01mis)$ISMB)))

beta02mns = aftsrr(Surv(X_pbc,D_pbc)~log_bili+prot+albu+age+edem+trt,eqType="mns",se="ISMB", pathsave = 50)
beta02mis = aftsrr(Surv(X_pbc,D_pbc)~log_bili+prot+albu+age+edem+trt,eqType="mis",se="ISMB", pathsave = 50)
summary(beta02mns)
cbind(coef(beta02mns) - 1.96 * sqrt(diag(vcov(beta02mns)$ISMB)),
      coef(beta02mns) + 1.96 * sqrt(diag(vcov(beta02mns)$ISMB)))
summary(beta02mis)
cbind(coef(beta02mis) - 1.96 * sqrt(diag(vcov(beta02mis)$ISMB)),
      coef(beta02mis) + 1.96 * sqrt(diag(vcov(beta02mis)$ISMB)))

# ------------------------------------------------------------------------------
# ------------------------------------------------------------------------------
# ------------------------------------------------------------------------------
setwd("C:/Users/WooJung/Documents/Rproject/afttest_analysis/RealDataAnalysis/PBCpackage", pathsave = 50)
save.image("C:/Users/WooJung/Documents/Rproject/afttest_analysis/RealDataAnalysis/PBCpackage/package_pbc0102.RData", pathsave = 50)

# ------------------------------------------------------------------------------
# ------------------------------------------------------------------------------
# ------------------------------------------------------------------------------
{
  # ------------------------------------------------------------------------------
  # ------------------------------------------------------------------------------
  cairo_ps("pbc01_omni_mis_unstd.eps",onefile=F,height=4,width=8, fallback_resolution = 600)
  afttestplot(result01_afttest_omni_mis,stdType="unstd", pathsave = 50)
  dev.off()
  cairo_ps("pbc01_omni_mis_std.eps",onefile=F,height=4,width=8, fallback_resolution = 600)
  afttestplot(result01_afttest_omni_mis,stdType="std", pathsave = 50)
  dev.off()
  cairo_ps("pbc01_link_mis_unstd.eps",onefile=F,height=4,width=8, fallback_resolution = 600)
  afttestplot(result01_afttest_link_mis,stdType="unstd", pathsave = 50)
  dev.off()
  cairo_ps("pbc01_link_mis_std.eps",onefile=F,height=4,width=8, fallback_resolution = 600)
  afttestplot(result01_afttest_link_mis,stdType="std", pathsave = 50)
  dev.off()
  cairo_ps("pbc01_form1_mis_unstd.eps",onefile=F,height=4,width=8, fallback_resolution = 600)
  afttestplot(result01_afttest_form1_mis,stdType="unstd", pathsave = 50)
  dev.off()
  cairo_ps("pbc01_form1_mis_std.eps",onefile=F,height=4,width=8, fallback_resolution = 600)
  afttestplot(result01_afttest_form1_mis,stdType="std", pathsave = 50)
  dev.off()
  cairo_ps("pbc01_form2_mis_unstd.eps",onefile=F,height=4,width=8, fallback_resolution = 600)
  afttestplot(result01_afttest_form2_mis,stdType="unstd", pathsave = 50)
  dev.off()
  cairo_ps("pbc01_form2_mis_std.eps",onefile=F,height=4,width=8, fallback_resolution = 600)
  afttestplot(result01_afttest_form2_mis,stdType="std", pathsave = 50)
  dev.off()
  cairo_ps("pbc01_form3_mis_unstd.eps",onefile=F,height=4,width=8, fallback_resolution = 600)
  afttestplot(result01_afttest_form3_mis,stdType="unstd", pathsave = 50)
  dev.off()
  cairo_ps("pbc01_form3_mis_std.eps",onefile=F,height=4,width=8, fallback_resolution = 600)
  afttestplot(result01_afttest_form3_mis,stdType="std", pathsave = 50)
  dev.off()
  cairo_ps("pbc01_form4_mis_unstd.eps",onefile=F,height=4,width=8, fallback_resolution = 600)
  afttestplot(result01_afttest_form4_mis,stdType="unstd", pathsave = 50)
  dev.off()
  cairo_ps("pbc01_form4_mis_std.eps",onefile=F,height=4,width=8, fallback_resolution = 600)
  afttestplot(result01_afttest_form4_mis,stdType="std", pathsave = 50)
  dev.off()
  
  # ------------------------------------------------------------------------------
  cairo_ps("pbc02_omni_mis_unstd.eps",onefile=F,height=4,width=8, fallback_resolution = 600)
  afttestplot(result02_afttest_omni_mis,stdType="unstd", pathsave = 50)
  dev.off()
  cairo_ps("pbc02_omni_mis_std.eps",onefile=F,height=4,width=8, fallback_resolution = 600)
  afttestplot(result02_afttest_omni_mis,stdType="std", pathsave = 50)
  dev.off()
  cairo_ps("pbc02_link_mis_unstd.eps",onefile=F,height=4,width=8, fallback_resolution = 600)
  afttestplot(result02_afttest_link_mis,stdType="unstd", pathsave = 50)
  dev.off()
  cairo_ps("pbc02_link_mis_std.eps",onefile=F,height=4,width=8, fallback_resolution = 600)
  afttestplot(result02_afttest_link_mis,stdType="std", pathsave = 50)
  dev.off()
  cairo_ps("pbc02_form1_mis_unstd.eps",onefile=F,height=4,width=8, fallback_resolution = 600)
  afttestplot(result02_afttest_form1_mis,stdType="unstd", pathsave = 50)
  dev.off()
  cairo_ps("pbc02_form1_mis_std.eps",onefile=F,height=4,width=8, fallback_resolution = 600)
  afttestplot(result02_afttest_form1_mis,stdType="std", pathsave = 50)
  dev.off()
  cairo_ps("pbc02_form2_mis_unstd.eps",onefile=F,height=4,width=8, fallback_resolution = 600)
  afttestplot(result02_afttest_form2_mis,stdType="unstd", pathsave = 50)
  dev.off()
  cairo_ps("pbc02_form2_mis_std.eps",onefile=F,height=4,width=8, fallback_resolution = 600)
  afttestplot(result02_afttest_form2_mis,stdType="std", pathsave = 50)
  dev.off()
  cairo_ps("pbc02_form3_mis_unstd.eps",onefile=F,height=4,width=8, fallback_resolution = 600)
  afttestplot(result02_afttest_form3_mis,stdType="unstd", pathsave = 50)
  dev.off()
  cairo_ps("pbc02_form3_mis_std.eps",onefile=F,height=4,width=8, fallback_resolution = 600)
  afttestplot(result02_afttest_form3_mis,stdType="std", pathsave = 50)
  dev.off()
  cairo_ps("pbc02_form4_mis_unstd.eps",onefile=F,height=4,width=8, fallback_resolution = 600)
  afttestplot(result02_afttest_form4_mis,stdType="unstd", pathsave = 50)
  dev.off()
  cairo_ps("pbc02_form4_mis_std.eps",onefile=F,height=4,width=8, fallback_resolution = 600)
  afttestplot(result02_afttest_form4_mis,stdType="std", pathsave = 50)
  dev.off()
  
  # ------------------------------------------------------------------------------
  # ------------------------------------------------------------------------------
  cairo_ps("pbc01_omni_mns_unstd.eps",onefile=F,height=4,width=8, fallback_resolution = 600)
  afttestplot(result01_afttest_omni_mns,stdType="unstd", pathsave = 50)
  dev.off()
  cairo_ps("pbc01_omni_mns_std.eps",onefile=F,height=4,width=8, fallback_resolution = 600)
  afttestplot(result01_afttest_omni_mns,stdType="std", pathsave = 50)
  dev.off()
  cairo_ps("pbc01_link_mns_unstd.eps",onefile=F,height=4,width=8, fallback_resolution = 600)
  afttestplot(result01_afttest_link_mns,stdType="unstd", pathsave = 50)
  dev.off()
  cairo_ps("pbc01_link_mns_std.eps",onefile=F,height=4,width=8, fallback_resolution = 600)
  afttestplot(result01_afttest_link_mns,stdType="std", pathsave = 50)
  dev.off()
  cairo_ps("pbc01_form1_mns_unstd.eps",onefile=F,height=4,width=8, fallback_resolution = 600)
  afttestplot(result01_afttest_form1_mns,stdType="unstd", pathsave = 50)
  dev.off()
  cairo_ps("pbc01_form1_mns_std.eps",onefile=F,height=4,width=8, fallback_resolution = 600)
  afttestplot(result01_afttest_form1_mns,stdType="std", pathsave = 50)
  dev.off()
  cairo_ps("pbc01_form2_mns_unstd.eps",onefile=F,height=4,width=8, fallback_resolution = 600)
  afttestplot(result01_afttest_form2_mns,stdType="unstd", pathsave = 50)
  dev.off()
  cairo_ps("pbc01_form2_mns_std.eps",onefile=F,height=4,width=8, fallback_resolution = 600)
  afttestplot(result01_afttest_form2_mns,stdType="std", pathsave = 50)
  dev.off()
  cairo_ps("pbc01_form3_mns_unstd.eps",onefile=F,height=4,width=8, fallback_resolution = 600)
  afttestplot(result01_afttest_form3_mns,stdType="unstd", pathsave = 50)
  dev.off()
  cairo_ps("pbc01_form3_mns_std.eps",onefile=F,height=4,width=8, fallback_resolution = 600)
  afttestplot(result01_afttest_form3_mns,stdType="std", pathsave = 50)
  dev.off()
  cairo_ps("pbc01_form4_mns_unstd.eps",onefile=F,height=4,width=8, fallback_resolution = 600)
  afttestplot(result01_afttest_form4_mns,stdType="unstd", pathsave = 50)
  dev.off()
  cairo_ps("pbc01_form4_mns_std.eps",onefile=F,height=4,width=8, fallback_resolution = 600)
  afttestplot(result01_afttest_form4_mns,stdType="std", pathsave = 50)
  dev.off()
  
  # ------------------------------------------------------------------------------
  cairo_ps("pbc02_omni_mns_unstd.eps",onefile=F,height=4,width=8, fallback_resolution = 600)
  afttestplot(result02_afttest_omni_mns,stdType="unstd", pathsave = 50)
  dev.off()
  cairo_ps("pbc02_omni_mns_std.eps",onefile=F,height=4,width=8, fallback_resolution = 600)
  afttestplot(result02_afttest_omni_mns,stdType="std", pathsave = 50)
  dev.off()
  cairo_ps("pbc02_link_mns_unstd.eps",onefile=F,height=4,width=8, fallback_resolution = 600)
  afttestplot(result02_afttest_link_mns,stdType="unstd", pathsave = 50)
  dev.off()
  cairo_ps("pbc02_link_mns_std.eps",onefile=F,height=4,width=8, fallback_resolution = 600)
  afttestplot(result02_afttest_link_mns,stdType="std", pathsave = 50)
  dev.off()
  cairo_ps("pbc02_form1_mns_unstd.eps",onefile=F,height=4,width=8, fallback_resolution = 600)
  afttestplot(result02_afttest_form1_mns,stdType="unstd", pathsave = 50)
  dev.off()
  cairo_ps("pbc02_form1_mns_std.eps",onefile=F,height=4,width=8, fallback_resolution = 600)
  afttestplot(result02_afttest_form1_mns,stdType="std", pathsave = 50)
  dev.off()
  cairo_ps("pbc02_form2_mns_unstd.eps",onefile=F,height=4,width=8, fallback_resolution = 600)
  afttestplot(result02_afttest_form2_mns,stdType="unstd", pathsave = 50)
  dev.off()
  cairo_ps("pbc02_form2_mns_std.eps",onefile=F,height=4,width=8, fallback_resolution = 600)
  afttestplot(result02_afttest_form2_mns,stdType="std", pathsave = 50)
  dev.off()
  cairo_ps("pbc02_form3_mns_unstd.eps",onefile=F,height=4,width=8, fallback_resolution = 600)
  afttestplot(result02_afttest_form3_mns,stdType="unstd", pathsave = 50)
  dev.off()
  cairo_ps("pbc02_form3_mns_std.eps",onefile=F,height=4,width=8, fallback_resolution = 600)
  afttestplot(result02_afttest_form3_mns,stdType="std", pathsave = 50)
  dev.off()
  cairo_ps("pbc02_form4_mns_unstd.eps",onefile=F,height=4,width=8, fallback_resolution = 600)
  afttestplot(result02_afttest_form4_mns,stdType="unstd", pathsave = 50)
  dev.off()
  cairo_ps("pbc02_form4_mns_std.eps",onefile=F,height=4,width=8, fallback_resolution = 600)
  afttestplot(result02_afttest_form4_mns,stdType="std", pathsave = 50)
  dev.off()
}











